<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VSTEP B1-B2 | 14 Ch·ªß ƒê·ªÅ T·ª´ V·ª±ng</title>
<link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@300;400;500;600;700;800;900&family=Playfair+Display:wght@700;800;900&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #f5f3ef;
  --surface: #ffffff;
  --surface2: #f0edea;
  --text: #1a1a2e;
  --text-dim: #6b7280;
  --accent: #e67e22;
  --accent2: #d35400;
  --green: #059669;
  --red: #dc2626;
  --blue: #2563eb;
  --purple: #7c3aed;
  --pink: #db2777;
  --cyan: #0891b2;
  --orange: #ea580c;
  --lime: #65a30d;
}

* { margin: 0; padding: 0; box-sizing: border-box; }

html { scroll-behavior: smooth; }

body {
  font-family: 'Be Vietnam Pro', sans-serif;
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  overflow-x: hidden;
}

/* === HEADER === */
.hero {
  position: relative;
  padding: 60px 24px 40px;
  text-align: center;
  overflow: hidden;
}

.hero::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(ellipse at 30% 50%, rgba(230,126,34,0.1) 0%, transparent 50%),
              radial-gradient(ellipse at 70% 50%, rgba(37,99,235,0.06) 0%, transparent 50%);
  animation: aurora 15s ease-in-out infinite;
}

@keyframes aurora {
  0%, 100% { transform: translate(0, 0) rotate(0deg); }
  33% { transform: translate(30px, -20px) rotate(1deg); }
  66% { transform: translate(-20px, 20px) rotate(-1deg); }
}

.hero h1 {
  font-family: 'Playfair Display', serif;
  font-size: clamp(2.2rem, 6vw, 3.8rem);
  font-weight: 900;
  background: linear-gradient(135deg, var(--accent), #1a1a2e, var(--accent2));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  letter-spacing: -1px;
  position: relative;
  margin-bottom: 8px;
}

.hero .subtitle {
  font-size: 1rem;
  color: var(--text-dim);
  font-weight: 300;
  position: relative;
}

.hero .subtitle span {
  color: var(--accent);
  font-weight: 600;
}

/* === MODE TABS === */
.mode-tabs {
  display: flex;
  justify-content: center;
  gap: 8px;
  padding: 16px 24px;
  position: sticky;
  top: 0;
  z-index: 100;
  background: rgba(245,243,239,0.9);
  backdrop-filter: blur(20px);
  border-bottom: 1px solid rgba(0,0,0,0.06);
}

.mode-tab {
  padding: 10px 20px;
  border: 1px solid rgba(0,0,0,0.1);
  border-radius: 100px;
  background: transparent;
  color: var(--text-dim);
  font-family: inherit;
  font-size: 0.85rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.3s;
}

.mode-tab:hover { border-color: var(--accent); color: var(--text); }
.mode-tab.active {
  background: var(--accent);
  color: #000;
  border-color: var(--accent);
  font-weight: 700;
}

/* === TOPIC NAV === */
.topic-nav {
  display: flex;
  gap: 8px;
  padding: 16px 24px;
  overflow-x: auto;
  scrollbar-width: none;
}
.topic-nav::-webkit-scrollbar { display: none; }

.topic-chip {
  flex-shrink: 0;
  padding: 8px 16px;
  border-radius: 100px;
  font-size: 0.8rem;
  font-weight: 500;
  cursor: pointer;
  border: 1px solid rgba(0,0,0,0.08);
  background: var(--surface);
  color: var(--text-dim);
  transition: all 0.3s;
  white-space: nowrap;
}

.topic-chip:hover { transform: translateY(-2px); border-color: rgba(0,0,0,0.15); }
.topic-chip.active { border-color: var(--accent); color: var(--accent); background: rgba(230,126,34,0.08); }

/* === CONTENT AREA === */
.content-area {
  max-width: 900px;
  margin: 0 auto;
  padding: 20px 24px 100px;
}

/* === STUDY MODE === */
.topic-section {
  margin-bottom: 48px;
  animation: fadeUp 0.5s ease;
}

@keyframes fadeUp {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

.topic-header {
  display: flex;
  align-items: center;
  gap: 14px;
  margin-bottom: 24px;
  padding-bottom: 16px;
  border-bottom: 2px solid rgba(0,0,0,0.06);
}

.topic-icon {
  width: 48px;
  height: 48px;
  border-radius: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.4rem;
  flex-shrink: 0;
}

.topic-title {
  font-family: 'Playfair Display', serif;
  font-size: 1.6rem;
  font-weight: 800;
}

.branch {
  margin-bottom: 20px;
  background: var(--surface);
  border-radius: 16px;
  border: 1px solid rgba(0,0,0,0.06);
  overflow: hidden;
  transition: border-color 0.3s;
  box-shadow: 0 1px 8px rgba(0,0,0,0.04);
}

.branch:hover { border-color: rgba(0,0,0,0.1); box-shadow: 0 4px 20px rgba(0,0,0,0.06); }

.branch-header {
  padding: 14px 20px;
  font-weight: 700;
  font-size: 0.95rem;
  display: flex;
  align-items: center;
  gap: 10px;
  cursor: pointer;
  user-select: none;
}

.branch-header .tag {
  padding: 3px 10px;
  border-radius: 6px;
  font-size: 0.7rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.branch-content {
  padding: 0 20px 16px;
}

.item {
  position: relative;
  padding: 10px 0 10px 20px;
  font-size: 0.9rem;
  line-height: 1.7;
  color: var(--text);
  border-left: 2px solid rgba(0,0,0,0.06);
  transition: all 0.2s;
}

.item:hover { border-left-color: var(--accent); }

.item::before {
  content: '';
  position: absolute;
  left: -5px;
  top: 16px;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--surface2);
  border: 2px solid rgba(0,0,0,0.12);
}

.item:hover::before { border-color: var(--accent); background: var(--accent); }

.item .vn {
  color: var(--text-dim);
  font-size: 0.82rem;
  font-style: italic;
}

.sub-items {
  margin-top: 6px;
  padding-left: 16px;
}

.sub-item {
  padding: 4px 0;
  font-size: 0.84rem;
  color: var(--text-dim);
  position: relative;
  padding-left: 14px;
}

.sub-item::before {
  content: '‚Üí';
  position: absolute;
  left: 0;
  color: rgba(0,0,0,0.15);
  font-size: 0.75rem;
}

/* === FLASHCARD MODE === */
.flashcard-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 24px;
  padding-top: 20px;
}

.flashcard-progress {
  font-size: 0.85rem;
  color: var(--text-dim);
}

.flashcard-progress span { color: var(--accent); font-weight: 700; }

.flashcard {
  width: 100%;
  max-width: 520px;
  min-height: 280px;
  perspective: 1000px;
  cursor: pointer;
}

.flashcard-inner {
  position: relative;
  width: 100%;
  min-height: 280px;
  transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  transform-style: preserve-3d;
}

.flashcard.flipped .flashcard-inner {
  transform: rotateY(180deg);
}

.flashcard-front, .flashcard-back {
  position: absolute;
  inset: 0;
  backface-visibility: hidden;
  border-radius: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 32px;
  text-align: center;
}

.flashcard-front {
  background: linear-gradient(145deg, var(--surface), var(--surface2));
  border: 1px solid rgba(0,0,0,0.08);
}

.flashcard-back {
  background: linear-gradient(145deg, #fff8f0, #fef3e2);
  border: 1px solid rgba(230,126,34,0.25);
  transform: rotateY(180deg);
}

.flashcard-topic-label {
  font-size: 0.7rem;
  text-transform: uppercase;
  letter-spacing: 1.5px;
  color: var(--accent);
  margin-bottom: 12px;
  font-weight: 600;
}

.flashcard-question {
  font-size: 1.2rem;
  font-weight: 600;
  line-height: 1.6;
}

.flashcard-answer {
  font-size: 1rem;
  line-height: 1.8;
  color: var(--text);
}

.flashcard-hint {
  margin-top: 20px;
  font-size: 0.75rem;
  color: var(--text-dim);
}

.flashcard-controls {
  display: flex;
  gap: 12px;
}

.fc-btn {
  padding: 12px 28px;
  border-radius: 100px;
  border: 1px solid rgba(0,0,0,0.1);
  background: var(--surface);
  color: var(--text);
  font-family: inherit;
  font-size: 0.85rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.3s;
}

.fc-btn:hover { border-color: var(--accent); }
.fc-btn.primary { background: var(--accent); color: #000; border-color: var(--accent); font-weight: 700; }

/* === QUIZ MODE === */
.quiz-container {
  max-width: 600px;
  margin: 0 auto;
}

.quiz-header {
  text-align: center;
  margin-bottom: 32px;
}

.quiz-score {
  display: flex;
  justify-content: center;
  gap: 32px;
  margin-bottom: 20px;
}

.quiz-score-item {
  text-align: center;
}

.quiz-score-item .num {
  font-size: 2rem;
  font-weight: 800;
  font-family: 'Playfair Display', serif;
}

.quiz-score-item .label {
  font-size: 0.7rem;
  color: var(--text-dim);
  text-transform: uppercase;
  letter-spacing: 1px;
}

.quiz-question-card {
  background: var(--surface);
  border-radius: 20px;
  padding: 32px;
  border: 1px solid rgba(0,0,0,0.06);
  margin-bottom: 20px;
}

.quiz-q-number {
  font-size: 0.7rem;
  text-transform: uppercase;
  letter-spacing: 1.5px;
  color: var(--accent);
  margin-bottom: 12px;
  font-weight: 600;
}

.quiz-q-text {
  font-size: 1.1rem;
  font-weight: 600;
  margin-bottom: 24px;
  line-height: 1.6;
}

.quiz-options {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.quiz-option {
  padding: 14px 20px;
  border-radius: 12px;
  border: 1px solid rgba(0,0,0,0.08);
  background: var(--surface2);
  color: var(--text);
  font-family: inherit;
  font-size: 0.9rem;
  cursor: pointer;
  transition: all 0.3s;
  text-align: left;
  font-weight: 400;
}

.quiz-option:hover:not(.disabled) {
  border-color: var(--accent);
  background: rgba(230,126,34,0.05);
}

.quiz-option.correct {
  border-color: var(--green);
  background: rgba(5,150,105,0.08);
  color: var(--green);
}

.quiz-option.wrong {
  border-color: var(--red);
  background: rgba(220,38,38,0.08);
  color: var(--red);
}

.quiz-option.disabled { cursor: default; opacity: 0.5; }

.quiz-next {
  display: block;
  margin: 20px auto 0;
  padding: 12px 32px;
  border-radius: 100px;
  border: none;
  background: var(--accent);
  color: #000;
  font-family: inherit;
  font-size: 0.9rem;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.3s;
}

.quiz-next:hover { transform: scale(1.05); }

/* === TEXT VIEW === */
.text-view {
  max-width: 800px;
  margin: 0 auto;
}

.text-topic {
  margin-bottom: 36px;
  padding: 24px;
  background: var(--surface);
  border-radius: 16px;
  border: 1px solid rgba(0,0,0,0.06);
}

.text-topic h2 {
  font-family: 'Playfair Display', serif;
  font-size: 1.3rem;
  margin-bottom: 16px;
  padding-bottom: 12px;
  border-bottom: 1px solid rgba(0,0,0,0.06);
}

.text-branch {
  margin-bottom: 12px;
}

.text-branch h3 {
  font-size: 0.9rem;
  font-weight: 700;
  margin-bottom: 6px;
  display: inline-block;
  padding: 2px 10px;
  border-radius: 6px;
}

.text-line {
  padding: 4px 0 4px 16px;
  font-size: 0.88rem;
  line-height: 1.8;
  color: var(--text);
  position: relative;
}

.text-line::before {
  content: '‚Ä¢';
  position: absolute;
  left: 0;
  color: var(--text-dim);
}

.text-sub {
  padding-left: 24px;
  color: var(--text-dim);
  font-size: 0.82rem;
}

.text-sub::before { content: '‚Ü≥'; }

/* === SEARCH === */
.search-bar {
  max-width: 500px;
  margin: 0 auto 24px;
  position: relative;
}

.search-bar input {
  width: 100%;
  padding: 14px 20px 14px 48px;
  border-radius: 100px;
  border: 1px solid rgba(0,0,0,0.08);
  background: var(--surface);
  color: var(--text);
  font-family: inherit;
  font-size: 0.9rem;
  outline: none;
  transition: border-color 0.3s;
}

.search-bar input:focus { border-color: var(--accent); }

.search-bar .search-icon {
  position: absolute;
  left: 18px;
  top: 50%;
  transform: translateY(-50%);
  color: var(--text-dim);
  font-size: 1rem;
}

.hidden { display: none !important; }

/* === RESPONSIVE === */
@media (max-width: 600px) {
  .hero { padding: 40px 16px 24px; }
  .content-area { padding: 16px 16px 80px; }
  .branch-header { padding: 12px 16px; }
  .branch-content { padding: 0 16px 12px; }
  .flashcard-front, .flashcard-back { padding: 24px; }
  .quiz-question-card { padding: 24px; }
  .mode-tabs { gap: 4px; padding: 12px 16px; }
  .mode-tab { padding: 8px 14px; font-size: 0.78rem; }
}

/* Color variants for topic icons */
.bg-yellow { background: linear-gradient(135deg, #fbbf24, #f59e0b); }
.bg-orange { background: linear-gradient(135deg, #fb923c, #ea580c); }
.bg-red { background: linear-gradient(135deg, #f87171, #dc2626); }
.bg-pink { background: linear-gradient(135deg, #f472b6, #db2777); }
.bg-purple { background: linear-gradient(135deg, #a78bfa, #7c3aed); }
.bg-blue { background: linear-gradient(135deg, #60a5fa, #2563eb); }
.bg-cyan { background: linear-gradient(135deg, #22d3ee, #0891b2); }
.bg-green { background: linear-gradient(135deg, #34d399, #059669); }
.bg-lime { background: linear-gradient(135deg, #a3e635, #65a30d); }
.bg-teal { background: linear-gradient(135deg, #2dd4bf, #0d9488); }

.tag-adv { background: rgba(5,150,105,0.12); color: var(--green); }
.tag-dis { background: rgba(220,38,38,0.1); color: var(--red); }
.tag-ben { background: rgba(37,99,235,0.1); color: var(--blue); }
.tag-draw { background: rgba(234,88,12,0.1); color: var(--orange); }
.tag-good { background: rgba(5,150,105,0.12); color: var(--green); }
.tag-bad { background: rgba(220,38,38,0.1); color: var(--red); }
.tag-sol { background: rgba(124,58,237,0.1); color: var(--purple); }
.tag-info { background: rgba(37,99,235,0.1); color: var(--blue); }
.tag-cause { background: rgba(234,88,12,0.1); color: var(--orange); }
.tag-like { background: rgba(5,150,105,0.12); color: var(--green); }
.tag-dislike { background: rgba(220,38,38,0.1); color: var(--red); }
.tag-prob { background: rgba(220,38,38,0.1); color: var(--red); }
</style>
</head>
<body>

<div class="hero">
  <h1>VSTEP B1-B2</h1>
  <p class="subtitle">Mindmap <span>14 ch·ªß ƒë·ªÅ</span> t·ª´ v·ª±ng th∆∞·ªùng g·∫∑p</p>
</div>

<div class="mode-tabs">
  <button class="mode-tab active" onclick="switchMode('study')">üìñ H·ªçc theo ch·ªß ƒë·ªÅ</button>
  <button class="mode-tab" onclick="switchMode('text')">üìù Xem d·∫°ng text</button>
  <button class="mode-tab" onclick="switchMode('flashcard')">üÉè Flashcard</button>
  <button class="mode-tab" onclick="switchMode('quiz')">üß† Tr·∫Øc nghi·ªám</button>
</div>

<div class="topic-nav" id="topicNav"></div>

<div class="content-area" id="contentArea"></div>

<script>
// ===== FULL DATA: 14 VSTEP TOPICS =====
const topics = [
  {
    id: "transport",
    name: "Transport",
    icon: "üöó",
    color: "bg-blue",
    branches: [
      {
        label: "Advantages", tag: "tag-adv", tagText: "∆ØU ƒêI·ªÇM",
        items: [
          { text: "Be safer", subs: ["Have fewer accidents"] },
          { text: "Never think about the weather", subs: ["Rain, storm, sun, dark at night", "Avoid getting wet, dust"] },
          { text: "Feel comfortable and relaxed", subs: ["Listen to music", "Read books / take a nap"] },
          { text: "Be convenient and fast", subs: ["Travel wherever I want and whenever I want"] }
        ]
      },
      {
        label: "Disadvantages", tag: "tag-dis", tagText: "NH∆Ø·ª¢C ƒêI·ªÇM",
        items: [
          { text: "Be inconvenient", subs: ["Run slowly ‚Üí transport infrastructure is in bad conditions", "Wait such a long time for the bus"] },
          { text: "Have a higher chance of getting diseases" },
          { text: "Be pretty crowded at rush hours" },
          { text: "Public transport systems are quite bad" }
        ]
      }
    ]
  },
  {
    id: "city",
    name: "City",
    icon: "üèôÔ∏è",
    color: "bg-yellow",
    branches: [
      {
        label: "Places", tag: "tag-info", tagText: "ƒê·ªäA ƒêI·ªÇM",
        items: [
          { text: "Restaurants, cinemas, shopping malls, skyscrapers (t√≤a nh√† ch·ªçc tr·ªùi)..." }
        ]
      },
      {
        label: "Disadvantages", tag: "tag-dis", tagText: "NH∆Ø·ª¢C ƒêI·ªÇM",
        items: [
          { text: "The city environment is heavily polluted", subs: ["Have polluted air ‚Üí have fewer trees, rivers, mountains", "The traffic is always heavy", "The roads are in bad conditions"] },
          { text: "The cost of living in the city is expensive", subs: ["Spend more money"] },
          { text: "City life is more dangerous", subs: ["Have more crimes", "City people are easily attracted by social evils ‚Üí drinking, drug, gambling..."] }
        ]
      },
      {
        label: "Advantages", tag: "tag-adv", tagText: "∆ØU ƒêI·ªÇM",
        items: [
          { text: "City life is interesting", subs: ["Have many entertainments ‚Üí restaurants, parks, cinemas"] },
          { text: "City life is more convenient", subs: ["Live near hospitals, supermarkets, schools"] },
          { text: "Have higher incomes", subs: ["Save more money", "Buy what I like"] },
          { text: "Have more career opportunities (c√≥ nhi·ªÅu c∆° h·ªôi ngh·ªÅ nghi·ªáp)" }
        ]
      }
    ]
  },
  {
    id: "countryside",
    name: "Countryside",
    icon: "üåæ",
    color: "bg-cyan",
    branches: [
      {
        label: "Places", tag: "tag-info", tagText: "ƒê·ªäA ƒêI·ªÇM",
        items: [
          { text: "Rice fields, rivers, mountains" }
        ]
      },
      {
        label: "Benefits", tag: "tag-ben", tagText: "L·ª¢I √çCH",
        items: [
          { text: "Bring me a clean environment", subs: ["Have fresher air ‚Üí enjoy the clean and fresh air", "Have many trees, rice fields, rivers"] },
          { text: "The cost of living is cheap", subs: ["Save a lot of money"] },
          { text: "People are more friendly, opener", subs: ["Live near each other", "Meet and talk to each other everyday"] }
        ]
      },
      {
        label: "Drawbacks", tag: "tag-draw", tagText: "H·∫†N CH·∫æ",
        items: [
          { text: "Have lower incomes" },
          { text: "Life is boring", subs: ["Not have many places of conveniences and pleasures ‚Üí restaurants, public parks, cinemas, downtown boutiques"] }
        ]
      }
    ]
  },
  {
    id: "health",
    name: "Health",
    icon: "ü©∫",
    color: "bg-purple",
    branches: [
      {
        label: "Good habits", tag: "tag-good", tagText: "TH√ìI QUEN T·ªêT",
        items: [
          { text: "Eat healthy food", subs: ["Eat more fruits, fish, vegetables", "Drink more water everyday"] },
          { text: "Eat less meat and fat food, junk food" },
          { text: "Exercise everyday" },
          { text: "Have a regular health check-up", subs: ["Visit a doctor regularly to find out any diseases soon"] }
        ]
      },
      {
        label: "Benefits of good habits", tag: "tag-ben", tagText: "L·ª¢I √çCH",
        items: [
          { text: "Stay healthy" },
          { text: "Keep fit" },
          { text: "Have a better immune system" },
          { text: "Make us strong and relaxed" }
        ]
      },
      {
        label: "Bad habits", tag: "tag-bad", tagText: "TH√ìI QUEN X·∫§U",
        items: [
          { text: "Eat too much unhealthy food", subs: ["Fat food, junk food ‚Üí be fast and convenient, have affordable meals, have various choices, enjoy comfortable atmosphere"] },
          { text: "Eat too much meat, eat less vegetables, less fruits" },
          { text: "Don't exercise regularly" },
          { text: "Don't have a regular health check-up" }
        ]
      },
      {
        label: "Problems", tag: "tag-prob", tagText: "V·∫§N ƒê·ªÄ",
        items: [
          { text: "Increase the risk of health problems" },
          { text: "Increase the cholesterol level in blood" },
          { text: "Can't focus on work or study" },
          { text: "It is easy to get tired and ill" },
          { text: "Diseases: obesity (b√©o ph√¨), diabetes (ti·ªÉu ƒë∆∞·ªùng), heart disease (b·ªánh tim m·∫°ch), sleep disturbance (r·ªëi lo·∫°n gi·∫•c ng·ªß), high blood pressure (cao huy·∫øt √°p)" }
        ]
      }
    ]
  },
  {
    id: "environment",
    name: "Environment",
    icon: "üåø",
    color: "bg-green",
    branches: [
      {
        label: "Good habits", tag: "tag-good", tagText: "TH√ìI QUEN T·ªêT",
        items: [
          { text: "Reuse and recycle products" },
          { text: "Consume less energy / save energy" },
          { text: "Sort trash" },
          { text: "Use more reusable products" }
        ]
      },
      {
        label: "Benefits", tag: "tag-ben", tagText: "L·ª¢I √çCH",
        items: [
          { text: "Protect the environment in the long term" },
          { text: "Conserve natural resources" },
          { text: "Reduce levels of pollution" },
          { text: "Tackle some causes of global warming" }
        ]
      },
      {
        label: "Drawbacks (environmental problems)", tag: "tag-draw", tagText: "H·∫¨U QU·∫¢",
        items: [
          { text: "Cause global warming / climate change" },
          { text: "Pollute the environment" },
          { text: "Exploit natural resources" },
          { text: "Increase greenhouse gas emissions" }
        ]
      }
    ]
  },
  {
    id: "hobbies",
    name: "Hobbies",
    icon: "üéµ",
    color: "bg-yellow",
    branches: [
      {
        label: "Synonyms (T·ª´ ƒë·ªìng nghƒ©a)", tag: "tag-info", tagText: "T·ª™ V·ª∞NG",
        items: [
          { text: "Free time activities" },
          { text: "Leisure activities" }
        ]
      },
      {
        label: "Types (C√°c lo·∫°i)", tag: "tag-info", tagText: "PH√ÇN LO·∫†I",
        items: [
          { text: "Listening to music, reading books, watching films" },
          { text: "Playing sports: swimming, tennis, table tennis, football" },
          { text: "Go jogging" },
          { text: "Go shopping" }
        ]
      },
      {
        label: "Advantages", tag: "tag-adv", tagText: "∆ØU ƒêI·ªÇM",
        items: [
          { text: "Bring happiness to me and my family", subs: ["Make me relaxed / feel much happier"] },
          { text: "Talk and share the joy with others" },
          { text: "Reduce the stress of everyday hard work and study" },
          { text: "Develop imagination and creativity" },
          { text: "Broaden the knowledge" },
          { text: "Develop the cognitive skills" }
        ]
      },
      {
        label: "Disadvantages (gaming)", tag: "tag-dis", tagText: "NH∆Ø·ª¢C ƒêI·ªÇM",
        items: [
          { text: "Games contain a great deal of violence" },
          { text: "Increase aggressive feelings, thoughts and behaviors" },
          { text: "Not focus on their duties and study", subs: ["Perform worse and worse at school"] }
        ]
      },
      {
        label: "Solutions", tag: "tag-sol", tagText: "GI·∫¢I PH√ÅP",
        items: [
          { text: "Choose suitable computer games" },
          { text: "Be not allowed to play violent games" },
          { text: "Set limits on the length of time for playing games" }
        ]
      }
    ]
  },
  {
    id: "job-study",
    name: "Job / Study",
    icon: "üíº",
    color: "bg-red",
    branches: [
      {
        label: "Introduction", tag: "tag-info", tagText: "GI·ªöI THI·ªÜU",
        items: [
          { text: "I am a third-year student at the university of..." },
          { text: "I work as an accountant for ABC company." }
        ]
      },
      {
        label: "Duties - Study", tag: "tag-info", tagText: "NHI·ªÜM V·ª§",
        items: [
          { text: "Do homework" },
          { text: "Make presentations" },
          { text: "Join clubs" },
          { text: "Do part-time jobs at the weekends" }
        ]
      },
      {
        label: "Duties - Work", tag: "tag-info", tagText: "NHI·ªÜM V·ª§",
        items: [
          { text: "I am in charge of...", subs: ["Working with clients", "Solving clients' problems", "Contacting partners"] },
          { text: "Collaborate with other departments to run the business smoothly" }
        ]
      },
      {
        label: "Opinion - Like", tag: "tag-like", tagText: "TH√çCH",
        items: [
          { text: "Apply the knowledge and skills of field I studied in my work" },
          { text: "Have an environment to develop skills" },
          { text: "Have opportunities for promotion (c√≥ c∆° h·ªôi thƒÉng ti·∫øn)" },
          { text: "Co-workers are friendly and supportive" }
        ]
      },
      {
        label: "Opinion - Dislike", tag: "tag-dislike", tagText: "KH√îNG TH√çCH",
        items: [
          { text: "Sometimes, I have to work overtime", subs: ["Have less time for family and friends"] },
          { text: "The company is far from home" },
          { text: "The workload is huge", subs: ["Feel tired / overloaded"] }
        ]
      }
    ]
  },
  {
    id: "crime",
    name: "Crime",
    icon: "‚ö†Ô∏è",
    color: "bg-pink",
    branches: [
      {
        label: "Causes", tag: "tag-cause", tagText: "NGUY√äN NH√ÇN",
        items: [
          { text: "Not be nurtured with love, care and support", subs: ["Parents are too busy with work"] },
          { text: "Get access to many violent games", subs: ["Copy bad things on the internet"] },
          { text: "Poverty", subs: ["Not have enough means to secure a living in the right ways ‚Üí commit crimes", "The easiest way to get what they want", "Not require any skills or talents"] }
        ]
      },
      {
        label: "Solutions", tag: "tag-sol", tagText: "GI·∫¢I PH√ÅP",
        items: [
          { text: "Parents should spend more time with children", subs: ["Control their activities and behaviors", "Give advice to children", "Prevent children from making mistakes"] },
          { text: "Punish those who commit a crime", subs: ["Send criminals to a rehabilitation center", "Learn how to behave well", "Get vocational training ‚Üí find a job later"] }
        ]
      }
    ]
  },
  {
    id: "house",
    name: "House / Flat",
    icon: "üè†",
    color: "bg-pink",
    branches: [
      {
        label: "Rooms", tag: "tag-info", tagText: "C√ÅC PH√íNG",
        items: [
          { text: "Living room, bedroom, bathroom, garden, garage, balcony, toilet" }
        ]
      },
      {
        label: "Adjectives", tag: "tag-info", tagText: "T√çNH T·ª™",
        items: [
          { text: "Large, big, spacious" },
          { text: "Quiet, peaceful" },
          { text: "Pretty, beautiful" },
          { text: "Stuffy (ng·ªôt ng·∫°t)" },
          { text: "Drafty (nhi·ªÅu gi√≥ l√πa)" },
          { text: "Cramped (ch·∫≠t ch·ªôi)" }
        ]
      },
      {
        label: "Furniture", tag: "tag-info", tagText: "N·ªòI TH·∫§T",
        items: [
          { text: "Table, TV, sofa, bookshelf, bed, wardrobe" }
        ]
      },
      {
        label: "Activities", tag: "tag-info", tagText: "HO·∫†T ƒê·ªòNG",
        items: [
          { text: "Grow plants and flowers in the garden" },
          { text: "Read books, watch TV, welcome guests in the living room" }
        ]
      }
    ]
  },
  {
    id: "technology",
    name: "Technology",
    icon: "üì±",
    color: "bg-orange",
    branches: [
      {
        label: "Advantages", tag: "tag-adv", tagText: "∆ØU ƒêI·ªÇM",
        items: [
          { text: "Perform faster and more efficiently" }
        ]
      },
      {
        label: "Disadvantages", tag: "tag-dis", tagText: "NH∆Ø·ª¢C ƒêI·ªÇM",
        items: [
          { text: "Have less social interactions" },
          { text: "Make people lazier", subs: ["Depend too much on machines ‚Üí refuse to do tasks by hand"] },
          { text: "Increase the unemployment rate" }
        ]
      },
      {
        label: "Solutions", tag: "tag-sol", tagText: "GI·∫¢I PH√ÅP",
        items: [
          { text: "Join social activities: team building, picnic, party" },
          { text: "Raise the sense of responsibility" },
          { text: "Take some programs or training courses to control modern machines" },
          { text: "Update themselves with the development of science and technology" }
        ]
      }
    ]
  },
  {
    id: "languages",
    name: "Learning Foreign Languages",
    icon: "üåê",
    color: "bg-blue",
    branches: [
      {
        label: "Benefits", tag: "tag-ben", tagText: "L·ª¢I √çCH",
        items: [
          { text: "Helps us learn and get information in the world", subs: ["Many books are written in English"] },
          { text: "Helps us feel more confident when travelling abroad", subs: ["Talk easily with foreigners", "Work and do business without an interpreter"] },
          { text: "Learn more about that country", subs: ["Culture, people, society, customs and traditions"] },
          { text: "Become friends with many people around the world" },
          { text: "Open a new door to the world" }
        ]
      }
    ]
  },
  {
    id: "machine",
    name: "Machine (Computer/Internet)",
    icon: "üíª",
    color: "bg-purple",
    branches: [
      {
        label: "Learning & Information", tag: "tag-ben", tagText: "H·ªåC T·∫¨P",
        items: [
          { text: "Be a good way of learning and getting information", subs: ["Read newspapers online", "Download lots of information", "Learn online"] }
        ]
      },
      {
        label: "Work & Study", tag: "tag-info", tagText: "C√îNG VI·ªÜC",
        items: [
          { text: "Be convenient for work, study", subs: ["Work faster and more efficiently ‚Üí typing, printing documents, storing data"] }
        ]
      },
      {
        label: "Entertainment", tag: "tag-like", tagText: "GI·∫¢I TR√ç",
        items: [
          { text: "Be a good way to entertain", subs: ["Play games", "Listen to music, watch movies", "Join forums, Facebook groups to share ideas and information"] }
        ]
      }
    ]
  },
  {
    id: "person",
    name: "Describe a Person",
    icon: "üë•",
    color: "bg-blue",
    branches: [
      {
        label: "Appearance", tag: "tag-info", tagText: "NGO·∫†I H√åNH",
        items: [
          { text: "Tall, short, old, young, medium-height, middle-aged" },
          { text: "Beautiful, pretty, handsome, good-looking" },
          { text: "Have short/long black hair" },
          { text: "Have a sunny smile" }
        ]
      },
      {
        label: "Characters - Good", tag: "tag-good", tagText: "T√çNH C√ÅCH T·ªêT",
        items: [
          { text: "Sincere = honest (th·∫≠t th√†)" },
          { text: "Helpful, kind, nice" },
          { text: "Generous (h√†o ph√≥ng)" }
        ]
      },
      {
        label: "Characters - Bad", tag: "tag-bad", tagText: "T√çNH C√ÅCH X·∫§U",
        items: [
          { text: "Talkative" },
          { text: "Awful, terrible, bad" },
          { text: "Selfish (√≠ch k·ª∑)" }
        ]
      },
      {
        label: "Relationship", tag: "tag-info", tagText: "M·ªêI QUAN H·ªÜ",
        items: [
          { text: "We have known each other for 10 years" },
          { text: "We first met at high school / at the company" }
        ]
      },
      {
        label: "Common activities", tag: "tag-like", tagText: "HO·∫†T ƒê·ªòNG CHUNG",
        items: [
          { text: "Often meet at the coffee shop" },
          { text: "Go shopping together" },
          { text: "Talk and share with each other about life, study, work, family..." }
        ]
      }
    ]
  },
  {
    id: "holiday",
    name: "Holiday",
    icon: "üèñÔ∏è",
    color: "bg-teal",
    branches: [
      {
        label: "Likes - Scenery", tag: "tag-like", tagText: "PHONG C·∫¢NH",
        items: [
          { text: "The scenery is magnificent", subs: ["There are breathtaking views of the mountains and rivers", "Enjoy fresh and pure air"] }
        ]
      },
      {
        label: "Likes - Food", tag: "tag-like", tagText: "·∫®M TH·ª∞C",
        items: [
          { text: "The local cuisine is fresh and delicious but not expensive", subs: ["Have a variety of food ‚Üí crab, lobsters, seashells"] }
        ]
      },
      {
        label: "Likes - People", tag: "tag-like", tagText: "CON NG∆Ø·ªúI",
        items: [
          { text: "People are friendly, sociable, polite" }
        ]
      },
      {
        label: "Activities", tag: "tag-info", tagText: "HO·∫†T ƒê·ªòNG",
        items: [
          { text: "Swim in the blue and clear seawater" },
          { text: "Do sunbathing on the soft sand beach under the yellow and warm sunshine" },
          { text: "Play football on the beach" },
          { text: "Build sandcastles on the beach" },
          { text: "Watch the sunrise / sunset" }
        ]
      }
    ]
  }
];

// ===== STATE =====
let currentMode = 'study';
let currentTopicIdx = 0;
let flashcardIdx = 0;
let flashcardDeck = [];
let quizIdx = 0;
let quizScore = { correct: 0, wrong: 0 };
let quizQuestions = [];

// ===== BUILD TOPIC NAV =====
function buildTopicNav() {
  const nav = document.getElementById('topicNav');
  nav.innerHTML = topics.map((t, i) =>
    `<div class="topic-chip ${i === currentTopicIdx ? 'active' : ''}" onclick="selectTopic(${i})">${t.icon} ${t.name}</div>`
  ).join('');
}

function selectTopic(idx) {
  currentTopicIdx = idx;
  buildTopicNav();
  renderContent();
  const el = document.getElementById(`topic-${topics[idx].id}`);
  if (el) el.scrollIntoView({ behavior: 'smooth', block: 'start' });
}

// ===== SWITCH MODE =====
function switchMode(mode) {
  currentMode = mode;
  document.querySelectorAll('.mode-tab').forEach(t => t.classList.remove('active'));
  event.target.classList.add('active');
  renderContent();
}

// ===== RENDER =====
function renderContent() {
  const area = document.getElementById('contentArea');
  if (currentMode === 'study') renderStudy(area);
  else if (currentMode === 'text') renderText(area);
  else if (currentMode === 'flashcard') renderFlashcard(area);
  else if (currentMode === 'quiz') renderQuiz(area);
}

// ----- STUDY MODE -----
function renderStudy(area) {
  area.innerHTML = `
    <div class="search-bar">
      <span class="search-icon">üîç</span>
      <input type="text" placeholder="T√¨m t·ª´ v·ª±ng..." oninput="filterStudy(this.value)">
    </div>
    <div id="studyContent">${topics.map(renderTopicSection).join('')}</div>
  `;
}

function renderTopicSection(topic) {
  return `
    <div class="topic-section" id="topic-${topic.id}" data-topic="${topic.name.toLowerCase()}">
      <div class="topic-header">
        <div class="topic-icon ${topic.color}">${topic.icon}</div>
        <div class="topic-title">${topic.name}</div>
      </div>
      ${topic.branches.map(b => `
        <div class="branch">
          <div class="branch-header">
            <span class="tag ${b.tag}">${b.tagText}</span>
            ${b.label}
          </div>
          <div class="branch-content">
            ${b.items.map(item => `
              <div class="item" data-search="${item.text.toLowerCase()} ${(item.subs||[]).join(' ').toLowerCase()}">
                ${item.text}
                ${item.subs ? `<div class="sub-items">${item.subs.map(s => `<div class="sub-item">${s}</div>`).join('')}</div>` : ''}
              </div>
            `).join('')}
          </div>
        </div>
      `).join('')}
    </div>
  `;
}

function filterStudy(query) {
  const q = query.toLowerCase().trim();
  document.querySelectorAll('.topic-section').forEach(section => {
    let hasMatch = false;
    section.querySelectorAll('.item').forEach(item => {
      const match = !q || item.dataset.search.includes(q);
      item.style.display = match ? '' : 'none';
      if (match) hasMatch = true;
    });
    section.style.display = (!q || hasMatch) ? '' : 'none';
  });
}

// ----- TEXT MODE -----
function renderText(area) {
  area.innerHTML = `<div class="text-view">${topics.map(t => `
    <div class="text-topic" id="topic-${t.id}">
      <h2>${t.icon} ${t.name}</h2>
      ${t.branches.map(b => `
        <div class="text-branch">
          <h3 class="${b.tag}">${b.tagText}: ${b.label}</h3>
          ${b.items.map(item => `
            <div class="text-line">${item.text}</div>
            ${(item.subs||[]).map(s => `<div class="text-line text-sub">${s}</div>`).join('')}
          `).join('')}
        </div>
      `).join('')}
    </div>
  `).join('')}</div>`;
}

// ----- FLASHCARD MODE -----
function buildFlashcardDeck() {
  flashcardDeck = [];
  topics.forEach(t => {
    t.branches.forEach(b => {
      b.items.forEach(item => {
        flashcardDeck.push({
          topic: t.name,
          topicIcon: t.icon,
          question: item.text,
          details: item.subs || [],
          branchLabel: b.label
        });
      });
    });
  });
  // shuffle
  for (let i = flashcardDeck.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [flashcardDeck[i], flashcardDeck[j]] = [flashcardDeck[j], flashcardDeck[i]];
  }
  flashcardIdx = 0;
}

function renderFlashcard(area) {
  if (!flashcardDeck.length) buildFlashcardDeck();
  const card = flashcardDeck[flashcardIdx];
  area.innerHTML = `
    <div class="flashcard-container">
      <div class="flashcard-progress">Th·∫ª <span>${flashcardIdx + 1}</span> / ${flashcardDeck.length}</div>
      <div class="flashcard" id="flashcard" onclick="document.getElementById('flashcard').classList.toggle('flipped')">
        <div class="flashcard-inner">
          <div class="flashcard-front">
            <div class="flashcard-topic-label">${card.topicIcon} ${card.topic} ‚Äî ${card.branchLabel}</div>
            <div class="flashcard-question">${card.question}</div>
            <div class="flashcard-hint">Nh·∫•n ƒë·ªÉ l·∫≠t th·∫ª</div>
          </div>
          <div class="flashcard-back">
            <div class="flashcard-topic-label">Chi ti·∫øt</div>
            <div class="flashcard-answer">
              ${card.details.length ? card.details.map(d => `‚Üí ${d}`).join('<br>') : '<em>Kh√¥ng c√≥ chi ti·∫øt th√™m</em>'}
            </div>
          </div>
        </div>
      </div>
      <div class="flashcard-controls">
        <button class="fc-btn" onclick="prevFlashcard()">‚Üê Tr∆∞·ªõc</button>
        <button class="fc-btn" onclick="buildFlashcardDeck(); renderFlashcard(document.getElementById('contentArea'))">üîÄ Tr·ªôn</button>
        <button class="fc-btn primary" onclick="nextFlashcard()">Ti·∫øp ‚Üí</button>
      </div>
    </div>
  `;
}

function nextFlashcard() {
  flashcardIdx = (flashcardIdx + 1) % flashcardDeck.length;
  renderFlashcard(document.getElementById('contentArea'));
}

function prevFlashcard() {
  flashcardIdx = (flashcardIdx - 1 + flashcardDeck.length) % flashcardDeck.length;
  renderFlashcard(document.getElementById('contentArea'));
}

// ----- QUIZ MODE -----
function buildQuiz() {
  quizQuestions = [];
  const allItems = [];
  topics.forEach(t => {
    t.branches.forEach(b => {
      b.items.forEach(item => {
        if (item.subs && item.subs.length) {
          allItems.push({ topic: t.name, branch: b.label, text: item.text, subs: item.subs });
        }
      });
    });
  });

  // Shuffle and pick 15
  for (let i = allItems.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [allItems[i], allItems[j]] = [allItems[j], allItems[i]];
  }

  const selected = allItems.slice(0, 15);
  selected.forEach(item => {
    // Generate question: "Which topic/branch does this belong to?"
    // Or: match the detail to the main point
    const correctAnswer = item.text;
    const wrongAnswers = allItems
      .filter(a => a.text !== item.text)
      .sort(() => Math.random() - 0.5)
      .slice(0, 3)
      .map(a => a.text);

    const options = [...wrongAnswers, correctAnswer].sort(() => Math.random() - 0.5);

    quizQuestions.push({
      question: `√ù n√†o sau ƒë√¢y c√≥ chi ti·∫øt: "${item.subs[0]}"?`,
      topic: item.topic,
      options,
      correct: correctAnswer
    });
  });

  quizIdx = 0;
  quizScore = { correct: 0, wrong: 0 };
}

function renderQuiz(area) {
  if (!quizQuestions.length) buildQuiz();

  if (quizIdx >= quizQuestions.length) {
    area.innerHTML = `
      <div class="quiz-container" style="text-align:center; padding-top:40px;">
        <div style="font-size:3rem; margin-bottom:16px;">üéâ</div>
        <h2 style="font-family:'Playfair Display',serif; font-size:1.8rem; margin-bottom:24px;">Ho√†n th√†nh!</h2>
        <div class="quiz-score">
          <div class="quiz-score-item"><div class="num" style="color:var(--green)">${quizScore.correct}</div><div class="label">ƒê√∫ng</div></div>
          <div class="quiz-score-item"><div class="num" style="color:var(--red)">${quizScore.wrong}</div><div class="label">Sai</div></div>
          <div class="quiz-score-item"><div class="num" style="color:var(--accent)">${Math.round(quizScore.correct/quizQuestions.length*100)}%</div><div class="label">T·ª∑ l·ªá</div></div>
        </div>
        <button class="quiz-next" onclick="buildQuiz(); renderQuiz(document.getElementById('contentArea'))">L√†m l·∫°i üîÑ</button>
      </div>
    `;
    return;
  }

  const q = quizQuestions[quizIdx];
  area.innerHTML = `
    <div class="quiz-container">
      <div class="quiz-header">
        <div class="quiz-score">
          <div class="quiz-score-item"><div class="num" style="color:var(--green)">${quizScore.correct}</div><div class="label">ƒê√∫ng</div></div>
          <div class="quiz-score-item"><div class="num" style="color:var(--red)">${quizScore.wrong}</div><div class="label">Sai</div></div>
        </div>
      </div>
      <div class="quiz-question-card">
        <div class="quiz-q-number">C√¢u ${quizIdx + 1} / ${quizQuestions.length} ‚Äî ${q.topic}</div>
        <div class="quiz-q-text">${q.question}</div>
        <div class="quiz-options" id="quizOptions">
          ${q.options.map((opt, i) => `
            <button class="quiz-option" onclick="answerQuiz(${i}, '${escapeStr(q.correct)}')">${opt}</button>
          `).join('')}
        </div>
      </div>
    </div>
  `;
}

function escapeStr(s) {
  return s.replace(/'/g, "\\'").replace(/"/g, '\\"');
}

function answerQuiz(selectedIdx, correct) {
  const buttons = document.querySelectorAll('.quiz-option');
  const selectedText = buttons[selectedIdx].textContent.trim();
  const isCorrect = selectedText === correct.replace(/\\'/g, "'").replace(/\\"/g, '"');

  buttons.forEach((btn, i) => {
    btn.classList.add('disabled');
    btn.onclick = null;
    if (btn.textContent.trim() === correct.replace(/\\'/g, "'").replace(/\\"/g, '"')) {
      btn.classList.add('correct');
    }
    if (i === selectedIdx && !isCorrect) {
      btn.classList.add('wrong');
    }
  });

  if (isCorrect) quizScore.correct++;
  else quizScore.wrong++;

  const card = document.querySelector('.quiz-question-card');
  card.insertAdjacentHTML('afterend', `<button class="quiz-next" onclick="quizIdx++; renderQuiz(document.getElementById('contentArea'))">C√¢u ti·∫øp theo ‚Üí</button>`);
}

// ===== INIT =====
buildTopicNav();
renderContent();
</script>
</body>
</html>
